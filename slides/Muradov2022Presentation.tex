\documentclass{beamer}
\beamertemplatenavigationsymbolsempty
\usecolortheme{beaver}
\setbeamertemplate{blocks}[rounded=true, shadow=true]
\setbeamertemplate{footline}[page number]
%
\usepackage[utf8]{inputenc}
\usepackage[english,russian]{babel}
\usepackage{amssymb,amsfonts,amsmath,mathtext}
\usepackage{subfig}
\usepackage[all]{xy} % xy package for diagrams
\usepackage{array}
\usepackage{multicol}% many columns in slide
\usepackage{hyperref}% urls
\usepackage{hhline}%tables
% Your figures are here:
\graphicspath{ {fig/} {../fig/} }

%----------------------------------------------------------------------------------------------------------
\title[\hbox to 56mm{Интерпретируемые CNN}]{Выбор интерпретируемых \\ сверточных моделей глубокого обучения}
\author[Т.\,Р. Мурадов]{Тимур Русланович Мурадов}
\institute{Московский физико-технический институт}
\date{\footnotesize
\par\smallskip\emph{Курс:} Моя первая научная статья\par (В.\,В.~Стрижов)/Группа Б05-907б
\par\smallskip\emph{Консультант:} О.~Бахтеев
\par\smallskip\emph{Консультант:} К.~Яковлев
\par\bigskip\small 2022}
%----------------------------------------------------------------------------------------------------------
\begin{document}
%----------------------------------------------------------------------------------------------------------
\begin{frame}
\thispagestyle{empty}
\maketitle
\end{frame}
%-----------------------------------------------------------------------------------------------------
\begin{frame}{Цель исследования}
	\begin{block}{Решается задача построения интерпретируемой сверточной нейронной сети}
	Под интерпретируемостью понимается простота выделения важных признаков на выборке данных и классификация близких объектов одним и тем же классификатором. 
	\end{block}
\end{frame}
%-----------------------------------------------------------------------------------------------------
\begin{frame}{Интерпретируемость изображений}

\begin{columns}[c]
\column{0.5\textwidth}
\includegraphics[width=0.75\textwidth]{../fig/example.png}
\column{0.5\textwidth}
\includegraphics[width=0.75\textwidth]{../fig/example_Lime.png}
\end{columns}

\bigskip
Выделение наиболее важных {\color{red}признаков} для изображений подразумевает собой подсветку {\color{red}формы} объекта соответствующего класса. 
\end{frame}
%----------------------------------------------------------------------------------------------------------
\begin{frame}{Литература}
\begin{enumerate}
	\item Marco Tulio Ribeiro, Sameer Singh, and Carlos Guestrin. Why should i trust you?: Explaining the
predictions of any classifier, 2016.
	\item Scott Lundberg and Su-In Lee. A unified approach to interpreting model predictions, 2017.
	\item Lingyang Chu, Xia Hu, Juhua Hu, Lanjun Wang, and Jian Pei. Exact and consistent interpretation for
piecewise linear neural networks: A closed form solution, 2019.
	\item Han Xiao, Kashif Rasul, and Roland Vollgraf. Fashion-mnist: a novel image dataset for benchmarking
machine learning algorithms, 2017.
\end{enumerate}
\end{frame}
%----------------------------------------------------------------------------------------------------------
\begin{frame}{Постановка задачи: модель и задача оптимизации}
Задана выборка $\mathbf{x} \in \mathbf{X}$ двумерные трехканальные изображения. $\mathbf{X} \in \{1, 2, ... k\}$, заданное конечное множество классов.

Рассматривается задача построения модели глубокого обучения для задачи классификации.

Модель $\mathbf{f}(\mathbf{X}, \mathbf{w})$ --- сверточная нейронная сеть, для краткости CNN, это суперпозиция подмоделей $\mathbf{f_1} \circ \mathbf{f_2} \dots \mathbf{f_n}$.

Функции $\mathbf{f_i}$ --- слои нейронной сети, это одни из функций: линейные $\mathbf{f_i} = \mathbf{w_0} + \Sigma \mathbf{w_i} * \mathbf{x_i}$, свертки $S(i,j) = (K * I)(i,j) = \Sigma_m \Sigma_n I(i + m, j + n)K(m, n)$, батч-нормы $\hat{x_i}^{(k)} = \frac{x_i^{(k)} - E(x_i^{(k)})}{\sqrt{D(x_i^{(k)})}}$ и пулинги.

$\mathbf{f}(\mathbf{X}, \mathbf{w})$ оптимизирует функцию кросс энтропии $\mathcal{L}$, $\mathbf{g}$ --- функция softmax.

$$\mathbf{g}(\mathbf{x})_i = \frac{e^{\mathbf{x_i}}}{\Sigma_j e^{\mathbf{x_j}}}$$
$$\mathcal{L} = -\Sigma_i \log \mathbf{g}(\mathbf{x})_i \to \max$$

\end{frame}
%----------------------------------------------------------------------------------------------------------
\begin{frame}{Постановка задачи: требования и критерии качества}

Кроме задачи оптимизации модель также должна удовлетворять следующим требованиям к итерпретируемости: $\textbf{Точность}$ и $\textbf{Консистентность}$.
\begin{itemize}
    \item \textbf{Точность}:
    Математическая эквивалентность.
    $$\mathbf{f}(\mathbf{X}, \mathbf{w}) = \mathbf{f_{true}}(\mathbf{X}, \mathbf{w})$$
    \item \textbf{Консистентность}:
    Близкие интерпретации для близких объектов выборки. $$\mathbf{x_i} \approx \mathbf{x_j} \Longrightarrow \mathbf{f}(\mathbf{x_i}, \mathbf{w}) \approx \mathbf{f}(\mathbf{x_j}, \mathbf{w})$$
\end{itemize}
Критерием качества рассматривается точность предсказания класса объектов. Отличие $P(i)$ для метода от истинной вероятности, полученной из классификатора, где $P$ - вероятность принадлежности к классу, $i$ - индекс рассматриваемого объекта.
\end{frame}
%----------------------------------------------------------------------------------------------------------
\begin{frame}{Решение задачи интерпретации CNN}
Предлагается адаптация метода \textbf{OpenBox} работающего с  кусочно-линейными нейронными сетями. В нём модель представляется в виде набора интерпретируемых линейных классификаторов. Каждый из них определен на выпуклом многограннике. Метод обобщается на работу с более широким классом нейронных сетей: сверточными нейронными сетями.
\end{frame}
%----------------------------------------------------------------------------------------------------------
\begin{frame}{Теоретическая часть}
\newtheorem{hypothesis}{Гипотеза}
\begin{hypothesis}
Слои сверточной нейронной сети: линейные, свертки, батч-нормализации, пулинги --- это линейные операции.
\end{hypothesis}

\begin{proof}
\begin{itemize}
    \item Линейный слой линеен по определению. 
    \item Свертка представима как линейная операция, если расписать её в специфичном виде как произведение матрицы входного изображения на матрицу с весами фильтра.
    \item Пулинг на максимум представим в виде взаимодействия фильтра на изображение как на политоп.
    \item Батч нормализация представима как скалярное произведение, применённое поэлементно к каждому изображению.
\end{itemize}
\end{proof}
\end{frame}
%----------------------------------------------------------------------------------------------------------
\begin{frame}{Базовый эксперимент}

 На графике представлена работа базового метода \textbf{LIME} по предсказанию класса объекта.

 \includegraphics[width=0.75\textwidth]{../fig/lime_and_true.png}


График говорит о хорошей аппроксимации базового метода.

\end{frame}
%----------------------------------------------------------------------------------------------------------
\begin{frame}{Эксперимент по адаптации метода OpenBox}

Рассматриваем простейшую модель сверточной нейронной сети и адаптируем метод \textbf{OpenBox}, далее сравниваем полученные результаты с приминением базового метода \textbf{LIME}. 

Эксперимент заключается в анализе влияния изменения картинок из датасета \textbf{Fashion MNIST} на значения градиентов при backward проходе. Что позволяет выделить на картинках наиболее важные признаки и степень их влияения на результат работы сверточной нейронной сети. 

\end{frame}
%----------------------------------------------------------------------------------------------------------
\begin{frame}{Заключение}
    \begin{block}{Результаты}
    \begin{itemize}
        \item Предложена адаптация метода OpenBox в применении к работе со сверточными нейронными сетями.
        \item Доказана гипотеза о линейности слоев сверточных нейронных сетей.
    \end{itemize}
    \end{block}
\end{frame}
%----------------------------------------------------------------------------------------------------------
\end{document} 
\end{frame}
%-----------------------------------------------------------------------------------------------------


\end{frame}
%----------------------------------------------------------------------------------------------------------
\begin{frame}{���������� ������}
\end{frame}
%----------------------------------------------------------------------------------------------------------
\begin{frame}{�������}
\end{frame}
%----------------------------------------------------------------------------------------------------------
\begin{frame}{�������������� �����������}
\end{frame}
%----------------------------------------------------------------------------------------------------------
\begin{frame}{����������}
\end{frame}
%----------------------------------------------------------------------------------------------------------
\end{document} 
